# ここからの手順（10問をランダムに出題するまで）

アプリで「10問がランダムに出題される」ようにするための手順です。

---

## 前提

- 作業するフォルダ: `c:\Users\hurri\OneDrive\デスクトップ\問題と苦しみ関連\mondai-kurushimi-quiz`
- このフォルダで **PowerShell** または **ターミナル** を開いてコマンドを実行します。

---

## 手順

### ステップ 1: コードの変更を push する（まだの場合）

`app.py` を変更したあと、まだ push していない場合だけ実行します。

```powershell
cd "c:\Users\hurri\OneDrive\デスクトップ\問題と苦しみ関連\mondai-kurushimi-quiz"
git status
```

`app.py` が「変更されています」と出たら、次を実行します。

```powershell
git add app.py
git commit -m "10問を重複なくランダム出題に修正"
git push origin main
```

すでに push 済みの場合はこのステップは飛ばしてOKです。

---

### ステップ 2: 10問入りの「問題と苦しみ.xlsx」を用意する

**10問をランダムに出題するには、Excel の NO1・NO2 シートにそれぞれ 10 行以上必要です。**

#### 方法A: サンプルで 10 問入り Excel を作る

1. **「問題と苦しみ.xlsx」を Excel で開いていたら閉じる。**
2. このフォルダで **create_sample_excel.py** をダブルクリックして実行する。  
   （またはターミナルで `python create_sample_excel.py`）
3. 同じフォルダに **「問題と苦しみ.xlsx」**（NO1・NO2 各10行）ができる。
4. 表示された「Enter キーを押すと閉じます...」で Enter を押して終了。

#### 方法B: 自分で作った Excel を使う

- 使いたい Excel を **「問題と苦しみ.xlsx」** の名前でこのフォルダにコピーする。
- **NO1 シート**（レベル1用）と **NO2 シート**（レベル2用）に、それぞれ **出来事・問題・苦しみ・回答** の列で **10 行以上** 入れる。

---

### ステップ 3: Excel を Git に追加して push する

ターミナルで、このフォルダにいることを確認してから実行します。

```powershell
cd "c:\Users\hurri\OneDrive\デスクトップ\問題と苦しみ関連\mondai-kurushimi-quiz"
git add "問題と苦しみ.xlsx"
git status
```

「問題と苦しみ.xlsx」が new file や変更として出ていればOKです。

```powershell
git commit -m "問題と苦しみ.xlsx を10問入りで同梱"
git push origin main
```

---

### ステップ 4: 再デプロイを待って確認する

1. **1〜3 分ほど待つ**（Streamlit Cloud が自動で再デプロイします）。
2. **スマホまたはPC** でアプリの URL を開き直す（タブを閉じて開き直すか、更新）。
3. **レベル1 または レベル2** を選んで「テスト開始（10問）」を押す。
4. **10問がランダムな順で出題される**ことを確認する。  
   「もう一度テストを始める」で、別の10問・別の順番になることも確認できます。

---

## コピペ用（まとめて実行）

すでに「問題と苦しみ.xlsx」が 10 行入りでこのフォルダにある場合:

```powershell
cd "c:\Users\hurri\OneDrive\デスクトップ\問題と苦しみ関連\mondai-kurushimi-quiz"
git add app.py "問題と苦しみ.xlsx"
git commit -m "10問ランダム出題とExcel同梱"
git push origin main
```

※ 1行目は、すでにこのフォルダでターミナルを開いている場合は不要です。

---

## うまくいかないとき

| 状況 | 対処 |
|------|------|
| まだ 2 問しか出ない | Excel の NO1・NO2 がそれぞれ 10 行以上か確認。create_sample_excel.py を実行し直してから再度 add → commit → push。 |
| push でエラー | `git pull origin main` を実行してから、再度 `git add` → `commit` → `push`。 |
| ログインを求められる | パスワード欄には **GitHub の Personal Access Token** を入力する（通常のパスワードでは不可）。 |

ここまでの手順で、URL から開いたアプリで 10 問がランダムに出題される状態になります。

---

## 変化しないときの確認（同じ問題が繰り返されるとき）

1. **アプリで「読み込み済み」の表示を確認する**  
   難易度選択の上に **「読み込み済み: レベル1＝〇件、レベル2＝〇件」** が出ます。  
   - **2件・2件のまま** → サーバーで使われている Excel がまだ古い（2行のまま）です。
2. **GitHub で 問題と苦しみ.xlsx を確認する**  
   - https://github.com/Doraemon9999/mondai-kurushimi-quiz を開く  
   - 一覧に **「問題と苦しみ.xlsx」** があるか  
   - クリックして **「Download」** でダウンロードし、Excel で開いて **NO1・NO2 がそれぞれ10行** あるか確認
3. **10行でない場合**  
   - 手元の **mondai-kurushimi-quiz** フォルダで **create_sample_excel.py** を実行（「問題と苦しみ.xlsx」は閉じておく）  
   - できた **「問題と苦しみ.xlsx」** を必ず **git add** して **push** する  
   ```powershell
   git add "問題と苦しみ.xlsx"
   git status
   git commit -m "問題と苦しみ.xlsx を10行で更新"
   git push origin main
   ```
4. **push 後**  
   - 1〜3分待ってから、アプリの URL を**タブを閉じて開き直す**（キャッシュを避ける）  
   - 再度「読み込み済み」が **レベル1＝10件、レベル2＝10件** になっているか確認

